{% extends 'base.html' %}

{% block title %}Fear & Greed Index{% endblock %}

{% block include_scripts_top %}
<script src="/static/js/site.js" type="text/javascript"></script>
<script src="//code.highcharts.com/highcharts.js" type="text/javascript"></script>
<script src="/static/js/charts/fear-and-greed.js" type="text/javascript"></script>

<script type="text/javascript">
let price_formatter_setup = {
    minimumFractionDigits: 0,
    maximumFractionDigits: 2,
    style: 'currency',
    currency: 'USD',
};
const price_formatter = new Intl.NumberFormat('en-US', price_formatter_setup);

let price_formatter_setup_low_values = {
    minimumFractionDigits: 0,
    maximumFractionDigits: 4,
    style: 'currency',
    currency: 'USD',
};
const price_formatter_low_values = new Intl.NumberFormat('en-US', price_formatter_setup_low_values);
</script>

<script type="text/javascript">
    function render_data(data, frequency) {
        let formatter = price_formatter;
        if (data.prices[0][1] < 1) {
            formatter = price_formatter_low_values;
        }
        create_chart_fear_and_greed(formatter, data, frequency);
        window.location.hash = frequency;
        $('#container_buttons > button').removeClass('button-primary').addClass('button-secondary');
        $('#' + frequency).removeClass('button-secondary').addClass('button-primary')
    }
</script>

<script type="text/javascript">
    $(document).ready(function() {
        const frequency = window.location.hash.replace('#', '');
        get_chart_cfgi_btc_data(render_data, frequency);
    });
</script>

<script type="text/javascript">
    $(document).ready(function() {
        $(".navbar-countdown").hide();
    });
</script>
{% endblock %}

{% block body %}

{% with url_ticker='ticker.ticker', params=dict() %}
{% include 'snippets/menu.html' %}
{% endwith %}

<br/><br/>

<div id="container_buttons" style="text-align: center">
    {% for cf in chart_frequencies %}
    <button class="button-secondary" id='{{ cf }}' onclick="get_chart_cfgi_btc_data(render_data, '{{ cf }}');">{{ cf }}</button>
    {% endfor %}
</div>

<br/>

<div id="chart"></div>
<br/>

{% endblock %}