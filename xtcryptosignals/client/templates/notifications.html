{% extends 'base.html' %}

{% block title %}Notifications{% endblock %}

{% block include_scripts_top %}
<script src="/static/js/site.js" type="text/javascript"></script>
<script>
    if ('serviceWorker' in navigator && 'PushManager' in window) {
      navigator.serviceWorker.register("{{ url_for('static', filename='js/service-worker.js')}}").then(
        function (serviceWorkerRegistration) {
          serviceWorkerRegistration.pushManager.subscribe({
            userVisibleOnly: true,
            applicationServerKey: '{{application_server_key}}'
          }).then(
            function (pushSubscription) {
              console.log(pushSubscription);
              $.ajax({
                url: '/subscription',
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify(pushSubscription),
                dataType: 'json'
              });
            }, function (error) {
              console.log('error = ' + error);
            }
          );
        }
      );
    }
</script>
{% endblock %}

{% block body %}

{% with url='ticker.ticker', params=dict() %}
{% include 'snippets/menu.html' %}
{% endwith %}


{% endblock %}
